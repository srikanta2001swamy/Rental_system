{% extends 'base.html' %}
{% block content %}
    <h2>Rental History</h2>
    <div class="form-container">
        <form method="POST">
            <select name="item_id" required>
                <option value="">Select Item</option>
                {% for item in items %}
                <option value="{{ item[0] }}">{{ item[1] }}</option>
                {% endfor %}
            </select>
            <select name="customer_id" required>
                <option value="">Select Customer</option>
                {% for customer in customers %}
                <option value="{{ customer[0] }}">{{ customer[1] }}</option>
                {% endfor %}
            </select>
            <input type="date" name="expected_return_date" required>
            <input type="number" step="0.01" name="advance_paid" placeholder="Advance Paid" required>
            <button type="submit" class="btn">Create Rental</button>
        </form>
    </div>
    <table>
        <tr>
            <th>ID</th>
            <th>Item</th>
            <th>Customer</th>
            <th>Rental Date</th>
            <th>Expected Return</th>
            <th>Advance Paid</th>
            <th>Total Amount</th>
            <th>Balance</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
        {% for rental in rentals %}
        <tr>
            <td>{{ rental[0] }}</td>
            <td>{{ rental[1] }}</td>
            <td>{{ rental[2] }}</td>
            <td>{{ rental[3] }}</td>
            <td>{{ rental[4] }}</td>
            <td>{{ rental[5] }}</td>
            <td>{{ rental[9] | round(2) }}</td>
            <td>{{ rental[10] | round(2) }}</td>
            <td>
                {% if rental[6] == 0 %}
                    Active
                {% else %}
                    Returned on {{ rental[7] }}
                {% endif %}
            </td>
            <td>
                {% if rental[6] == 0 %}
                <form method="POST" action="{{ url_for('return_rental', id=rental[0]) }}">
                    <button type="submit" class="btn btn-return">Return</button>
                </form>
                {% else %}
                -
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}
